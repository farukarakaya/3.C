<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

   <h:head>
       <style type="text/css">
           #map {
               height: 100%;
               width: 100%;
           }
       </style>
       <script type="text/javascript" src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"/>
       <script  type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDCSSCWTUs22Y7P48TIct292Esi-iBXujw" />
       <script type="text/javascript" src="js/map.js"/>
   </h:head>

     <h:body >
      <p:layout fullPage="true">
         <p:layoutUnit position="north"  size="200"  >
             <p:graphicImage value="images/banner.png" style="float: left; width: 80%" />
             <p:outputPanel id="menuPanel" style="float: right">
                 <h:form>
                     <p:menu value="Options" rendered="#{sessionView.admin}">
                         <p:menuitem value="Manage Your Entries" oncomplete="PF('announcementPopup').show()" icon="ui-icon-arrowrefresh-1-w"/>
                         <p:menuitem value="Submit New" oncomplete="PF('submitNew').show()"  icon="ui-icon-close"/>
                         <p:menuitem value="Account Settings" oncomplete="PF('announcementPopup').show()"  icon="ui-icon-close"/>
                         <p:menuitem value="Manage Users" oncomplete="PF('announcementPopup').show()"  icon="ui-icon-close"/>
                         <p:separator/>
                         <p:menuitem value="Sign Out" actionListener="#{sessionView.logOut}" update="menuPanel" icon="ui-icon-extlink"/>
                     </p:menu>
                     <p:menu value="Options" rendered="#{sessionView.user}">
                         <p:menuitem value="Manage Your Entries" actionListener="#{menuView.dummy}" update="" icon="ui-icon-arrowrefresh-1-w"/>
                         <p:menuitem value="Submit New" oncomplete="PF('submitNew').show()" icon="ui-icon-close"/>
                         <p:menuitem value="Account Settings" actionListener="#{menuView.dummy}" ajax="false" icon="ui-icon-close"/>
                         <p:separator/>
                         <p:menuitem value="Sign Out" actionListener="#{sessionView.logOut}" update="menuPanel" icon="ui-icon-extlink"/>
                     </p:menu>
                     <p:panelGrid columns="2" cellpadding="0" rendered="#{sessionView.guest}">
                        <h:outputLabel value="email:"/>
                        <p:inputText value="#{sessionView.email}" />
                         <h:outputLabel value="password:"/>
                         <p:password id="nonFeedback" value="#{sessionView.password}" />
                         <p:commandButton value="Log In" id="Login" actionListener="#{sessionView.logIn}" update="menuPanel" styleClass="ui-priority-primary" />
                         <h:panelGrid columns="3">
                             <h:outputLabel value="or you can"/>
                             <p:spacer width="15"/>
                             <p:commandButton value="Sıgn In" id="signin" onclick="PF('signInPopup').show()" styleClass="ui-priority-primary" /></h:panelGrid>
                     </p:panelGrid>
                 </h:form>
             </p:outputPanel>
             <h:form>
                 <p:remoteCommand name="sendCity" process="@this" update="DistrictFilter" action="#{mapView.setCity}"/>
                 <p:remoteCommand name="sendDistrict" process="@this"  action="#{mapView.setDistrict}"/>
                 <p:remoteCommand name="sendType" process="@this"  action="#{mapView.setType}"/>
             </h:form>
             <p:panelGrid columns="5" cellpadding="1">
                 <p:selectOneMenu id="CityFilter" widgetVar="CityFilter" value="#{mapView.city}" style="width:125px" filter="true" filterMatchMode="startsWith">
                     <f:selectItem itemLabel="Select City"  itemValue="" />
                     <f:selectItems value="#{mapView.cities}" var="city" itemValue="#{city}" />
                     <p:ajax event="change" oncomplete="sendSelectedCity(value)"/>
                 </p:selectOneMenu>
                 <p:selectOneMenu disabled="#{mapView.citySelected}" id="DistrictFilter" value="#{mapView.district}" filter="true" filterMatchMode="startsWith" style="width:125px">
                    <f:selectItem  itemLabel="Select District" itemValue="" />
                    <f:selectItems value="#{mapView.districts}" />
                    <p:ajax event="change" oncomplete="sendSelectedDistrict(value)"/>
                 </p:selectOneMenu>
                 <p:selectOneMenu  id="TypeFilter" value="#{mapView.typeSelected}" filter="true" filterMatchMode="startsWith" style="width:125px">
                     <f:selectItem  itemLabel="Select Type" itemValue="" />
                     <f:selectItems value="#{mapView.types}" />
                     <p:ajax event="change" oncomplete="sendSelectedType(value)"/>
                 </p:selectOneMenu>
                 <p:selectManyCheckbox id="basic" value="#{mapView.needDonation}">
                     <f:selectItem itemLabel="Donation" itemValue="Donation" />
                     <f:selectItem itemLabel="Need" itemValue="Need" />
                 </p:selectManyCheckbox>
                 <p:commandButton id="fiterButton" value="Filter"/>
             </p:panelGrid>
         </p:layoutUnit>
         <p:layoutUnit position="east" id="east" size="400">
                 <p:dataScroller value="#{dataScrollerView.announcements}" var="announcement" chunkSize="10" mode="inline"
                                 scrollHeight="450">
                     <h:panelGrid columns="2" style="width:100%" columnClasses="logo,detail">
                         <p:graphicImage value="images/embed2.jpg" width="120" height="100"/>
                         <p:outputPanel>
                             <h:form>
                                 <p:remoteCommand name="sendID" process="@this" oncomplete="PF('announcementPopup').show()"
                                                 update="announcementPopup" action="#{mapView.setAnnouncementToShow}" />
                             </h:form>
                             <h:panelGrid columns="1" cellpadding="2">
                                 <h:outputText value="#{announcement.title}" style="font-weight: bold"/>

                                 <h:outputText value="#{announcement.id}" style="font-weight: bold"/>

                                 <p:commandButton value="Show" id="scrollbutton"  onclick="clickAnnouncement(#{announcement.id})"/>

                             </h:panelGrid>
                         </p:outputPanel>
                     </h:panelGrid>
                     <p:separator />
                 </p:dataScroller>
         </p:layoutUnit>
         <p:layoutUnit id="center" position="center" value='10' >
             <input type="hidden" name="filter" value='10' />
             <div id="map" >
                 <script type="text/javascript">
                     getAnnouncements(#{mapView.announcementsMap});
                     initMap();
                 </script>
                 <p:dialog header="#{mapView.getAnnouncememtByID().title}" id="announcementPopup" widgetVar="announcementPopup"
                           showEffect="drop" hideEffect="drop" resizable="false" dynamic="true" closeOnEscape="true" position="150,250" >
                     <p:graphicImage value="images/embed2.jpg" width="240" height="200" style="float: left"/>
                     <h:panelGrid columns="1" style="margin-bottom:10px; float: left" cellpadding="5">
                         <h:outputText value="#{mapView.getAnnouncememtByID().detail}" style="font-weight: mormal"/>
                         <h:outputText rendered="#{sessionView.user}" value="#{mapView.getAnnouncememtByID().contactInfo}" style="font-weight: mormal"/>
                     </h:panelGrid>
                 </p:dialog>
             </div>
         </p:layoutUnit>
         <p:layoutUnit position="south" size="50">

             <p:dialog header="Sumnit New Announcement" id="submitNew" widgetVar="submitNew"  style="min-width: 800px; min-height: 600px;"
                       showEffect="drop" hideEffect="drop" resizable="false" dynamic="true" closeOnEscape="true" position="550,50" >
                 <h:form id="submitFirstTab" prependId="false">
                     <p:messages id="submitMessages" showDetail="true" autoUpdate="true" />
                 <p:accordionPanel id="sumbitNewAcordion" widgetVar="sumbitNewAcordion">
                     <p:tab title="General İnformation">

                             <p:remoteCommand name="sendCity" process="@this" update="districtsubmit,sumbitGInfButton" action="#{createAnnouncementView.setCity}"/>
                             <p:remoteCommand name="sendDistrict" process="@this" update="address,sumbitGInfButton" action="#{createAnnouncementView.setDistrict}"/>
                             <p:remoteCommand name="sendType" process="@this"  update="sumbitGInfButton" action="#{createAnnouncementView.setType}"/>
                             <p:remoteCommand name="sendNeedDonation" process="@this"  update="sumbitGInfButton,verifyAdress" action="#{createAnnouncementView.setNeedDonation}"/>
                             <p:remoteCommand name="SendAddress" process="@this"  update="sumbitGInfButton" action="#{createAnnouncementView.setAddress}"/>
                             <p:remoteCommand name="SendTitle" process="@this"  update="sumbitGInfButton" action="#{createAnnouncementView.setTitle}"/>
                             <h:panelGrid columns="2" cellpadding="1">
                                 <h:panelGrid columns="2" cellpadding="1">
                                     <h:outputLabel for="title" value="Title" />
                                     <p:inputText id="title" value="#{createAnnouncementView.title}" label="Title">
                                         <p:ajax event="change" oncomplete="sendtitle(value)"/>
                                     </p:inputText>
                                     <h:outputLabel for="citysubmit" value="City" />
                                     <p:selectOneMenu id="citysubmit" widgetVar="citysubmit" value="#{createAnnouncementView.city}"
                                                      required="true" requiredMessage="This value is required." style="width:125px" filter="true" filterMatchMode="startsWith">
                                         <f:selectItem itemLabel="Select City"  itemValue="" />
                                         <f:selectItems value="#{createAnnouncementView.cities}" var="city" itemValue="#{city}" />
                                         <p:ajax event="change" oncomplete="sendSelectedCity(value)"/>
                                     </p:selectOneMenu>
                                     <h:outputLabel for="citysubmit" value="District" />
                                     <p:selectOneMenu disabled="#{createAnnouncementView.citySelected}" id="districtsubmit" widgetVar="districtsubmit" value="#{createAnnouncementView.district}"
                                                      filter="true" filterMatchMode="startsWith"  required="true" requiredMessage="This value is required." style="width:125px">
                                         <f:selectItem  itemLabel="Select District" itemValue="" />
                                         <f:selectItems value="#{createAnnouncementView.districts}" />
                                         <p:ajax event="change" oncomplete="sendSelectedDistrict(value)"/>
                                     </p:selectOneMenu>
                                     <h:outputLabel for="address" value="Address" />
                                     <p:inputTextarea disabled="#{createAnnouncementView.districtSelected}" id="address" widgetVar="address" value="#{createAnnouncementView.address}" label="Address">
                                         <p:ajax event="change" oncomplete="sendAdress(value)"/>
                                     </p:inputTextarea>
                                     <h:outputLabel for="typesumbit" value="Category" />
                                     <p:selectOneMenu  id="typesumbit" value="#{createAnnouncementView.typeSelected}" filter="true" filterMatchMode="startsWith" style="width:125px">
                                         <f:selectItem  itemLabel="Select Type" itemValue="" />
                                         <f:selectItems value="#{createAnnouncementView.types}" />
                                         <p:ajax event="change" oncomplete="sendSelectedType(value)"/>
                                     </p:selectOneMenu>
                                     <h:outputLabel for="checbox" value="Need Or Donation" />
                                     <p:selectOneRadio id="checbox" value="#{createAnnouncementView.needDonation}">
                                         <f:selectItem itemLabel="Donation" itemValue="Donation" />
                                         <f:selectItem itemLabel="Need" itemValue="Need" />
                                         <p:ajax event="change" oncomplete="sendND(value)"/>
                                     </p:selectOneRadio>
                                     <p:commandButton disabled="#{createAnnouncementView.button1Active}" id="sumbitGInfButton" value="submitGeneralInfo"  update="@this" onclick="geocode()"
                                                      validateClient="true" style="margin-top:10px;" />
                                 </h:panelGrid>
                                 <h:panelGrid columns="1" cellpadding="1" id="verifyPanel" widgetwar="verifyPanel">
                                     <h:outputLabel for="geoMap" value="Verify Address" />
                                     <p:gmap id="geoMap" widgetVar="geoMap" center="#{createAnnouncementView.centerGeoMap}"  zoom="15" type="HYBRID"  model="#{createAnnouncementView.geoModel}" style="width:300px;height:300px">
                                         <p:ajax event="geocode" listener="#{createAnnouncementView.onGeocode}" update="@this" />
                                         <p:ajax event="markerDrag" listener="#{createAnnouncementView.onMarkerDrag}"  />
                                     </p:gmap>
                                     <p:commandButton disabled="#{createAnnouncementView.button1Active}" id="verifyAdress" value="verify Adress" update="@this" onclick="PF('sumbitNewAcordion').select(1)"
                                                      style="margin-top:10px;" />
                                 </h:panelGrid>
                             </h:panelGrid>
                     </p:tab>
                     <p:tab title="Description and Contact Information" >
                         <h:panelGrid columns="1" cellpadding="0">
                             <h:outputText value="Enter Descirption" />
                             <p:inputTextarea widgetVar="deciriptionEditor" value="#{createAnnouncementView.desciription}" height="100" style=" width:692px; margin-bottom:10px"/>
                             <h:outputText value="Enter Contact Information" />
                             <p:inputTextarea widgetVar="ContactInfoEditor" value="#{createAnnouncementView.contactInfo}" height="100" style="width:692px; margin-bottom:10px"/>
                             <p:commandButton  id="submitDesConInf" value="Submit"  update="@this" onclick="PF('sumbitNewAcordion').select(2)"
                                               validateClient="true" style="margin-top:10px;" />
                         </h:panelGrid>
                     </p:tab>
                     <p:tab title="Photo">
                         <h:panelGrid columns="2" cellpadding="1">
                             <p:fileUpload value="#{createAnnouncementView.file}" mode="simple" skinSimple="true"/>

                             <p:commandButton value="Submit" ajax="false" actionListener="#{createAnnouncementView.upload}" update="center,east" disabled="false" />

                             <p:graphicImage rendered="false" value="images/embed2.jpg" />
                         </h:panelGrid>
                     </p:tab>
                 </p:accordionPanel>
             </h:form>
             </p:dialog>
             <p:dialog header="Sıgn In" id="signInPopup" widgetVar="signInPopup"
                       showEffect="drop" hideEffect="drop" resizable="false" dynamic="true" closeOnEscape="true" position="550,250" >
                 <p:messages id="messages" showDetail="true" autoUpdate="true" />
                 <h:form id="signInForm" prependId="false">
                     <p:panelGrid rendered="#{menuView.signedIn1}" id="SignInGrid" columns="2" cellpadding="1">
                         <p:outputLabel value="Full Name"/>
                         <p:inputText value="#{menuView.fullName}" required="true" />
                         <p:outputLabel value="E-Mail" required="true"/>
                         <p:inputText value="#{menuView.email}" required="true"/>
                         <p:outputLabel value="Password"/>
                         <p:password id="password1" value="#{menuView.password}" match="password2" required="true"/>
                         <p:outputLabel value="Confirm Password"/>
                         <p:password id="password2" value="#{menuView.cPassword}" required="true"/>
                         <p:commandButton value="Sign In" update="signInForm" actionListener="#{menuView.singIn}" />
                     </p:panelGrid>
                     <p:outputLabel rendered="#{menuView.signedIn2}" value="Please Enter Your Verification Code That Sent Your Email"/>
                     <p:panelGrid columns="3" cellPadding="0" rendered="#{menuView.signedIn2}">
                         <p:outputLabel value="vcode: "/>
                         <p:inputText value="#{menuView.vcode}" required="true" />
                         <p:commandButton value="Sign In" update="@this" actionListener="#{menuView.validate}"/>
                     </p:panelGrid>
                 </h:form>
             </p:dialog>
         </p:layoutUnit>
      </p:layout>
     </h:body>

</html>
